<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Номенклатура неорганики</title>

<style>
:root {
  --bg: #ffffff;
  --card: #fafafa;
  --border: #e5e5e5;
  --text: #111;
  --muted: #666;
  --accent: #0066ff;

  --ok: #16a34a;
  --bad: #dc2626;
}

body {
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
               "Segoe UI", Roboto, Arial, sans-serif;
  margin: 0;
  line-height: 1.3;
}

.container {
  max-width: 1080px;
  margin: 0 auto;
  padding: 16px;
}

.header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.back {
  text-decoration: none;
  color: var(--muted);
  font-size: 14px;
}

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 18px;
  margin-bottom: 12px;
}

.stats {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin: 10px 0;
}

.pill {
  background: white;
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 13px;
}

.question {
  font-size: 26px;
  margin: 12px 0 4px 0;
  letter-spacing: -0.2px;
}

.tip {
  font-size: 13px;
  color: var(--muted);
}

.answers {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
  margin-top: 14px;
}

@media (min-width: 760px) {
  .answers { grid-template-columns: 1fr 1fr; }
}

.btn {
  text-align: left;
  padding: 14px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: white;
  cursor: pointer;
  font-size: 16px;
  transition: all .15s;
}

.btn:hover { background: #f5f5f5; }

.btn.selected {
  border-color: var(--accent);
  background: #f0f6ff;
}

.btn.correct {
  border-color: var(--ok);
  background: #f0fdf4;
}

.btn.wrong {
  border-color: var(--bad);
  background: #fef2f2;
}

.primary {
  padding: 12px 16px;
  border-radius: 14px;
  border: none;
  background: var(--text);
  color: white;
  font-size: 15px;
  cursor: pointer;
}

.primary:disabled {
  opacity: .4;
}

.secondary {
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: white;
  cursor: pointer;
}

.row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  margin-top: 12px;
}

/* Навигация по номерам */
.nav {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.qbtn {
  width: 36px;
  height: 32px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: white;
  font-size: 12px;
  cursor: pointer;
}

.qbtn.current {
  border-color: var(--text);
}

.qbtn.right {
  border-color: var(--ok);
  background: #f0fdf4;
}

.qbtn.wrong {
  border-color: var(--bad);
  background: #fef2f2;
}

.settings {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 12px;
  font-size: 13px;
  color: var(--muted);
}

</style>
</head>

<body>
<div class="container">

<div class="header">
  <a class="back" href="index.html">← Главная</a>
</div>

<div class="card">
  <div class="stats">
    <span class="pill"><span id="qIndex">1</span>/<span id="qTotal">0</span></span>
    <span class="pill" id="okCount">0</span>
    <span class="pill" id="badCount">0</span>
    <span class="pill"><span id="score">0</span>%</span>
  </div>

  <div class="question" id="question">—</div>
  <div class="tip" id="tip"> </div>

  <div class="answers" id="answers"></div>

  <div class="row">
    <button id="actionBtn" class="primary" disabled>Ответить</button>
    <button id="prevBtn" class="secondary">Назад</button>
    <button id="nextBtn" class="secondary">Вперёд</button>
  </div>
</div>

<div class="card">
  <div class="nav" id="nav"></div>

  <div class="settings">
    <label><input type="checkbox" id="shuffle" checked> перемешать вопросы</label>
    <label><input type="checkbox" id="mixAnswers" checked> перемешать ответы</label>
    <label><input type="checkbox" id="autoNextCorrect"> авто при верном</label>
    <label><input type="checkbox" id="autoNextWrong"> авто при ошибке</label>
  </div>

  <div class="row">
    <button id="restartBtn" class="secondary">Сначала</button>
    <button id="repeatWrongBtn" class="secondary">Ошибки</button>
  </div>
</div>

</div>

<script>
// --- БАНК 32 ВОПРОСОВ ---
const TASKS = [
  { f:"CO", right:"оксид углерода(ii)", tip:"C(+2)" },
  { f:"CO2", right:"оксид углерода(iv)", tip:"C(+4)" },
  { f:"SO2", right:"оксид серы(iv)", tip:"S(+4)" },
  { f:"SO3", right:"оксид серы(vi)", tip:"S(+6)" },
  { f:"P2O5", right:"оксид фосфора(v)", tip:"P(+5)" },
  { f:"N2O5", right:"оксид азота(v)", tip:"N(+5)" },
  { f:"FeO", right:"оксид железа(ii)", tip:"Fe(+2)" },
  { f:"Fe2O3", right:"оксид железа(iii)", tip:"Fe(+3)" },
  { f:"Cu2O", right:"оксид меди(i)", tip:"Cu(+1)" },
  { f:"CuO", right:"оксид меди(ii)", tip:"Cu(+2)" },

  { f:"HCl", right:"соляная кислота", tip:"раствор HCl" },
  { f:"H2S", right:"сероводородная кислота", tip:"слабая" },
  { f:"H2SO4", right:"серная кислота", tip:"сильная, 2-осн." },
  { f:"H2SO3", right:"сернистая кислота", tip:"SO2 + H2O" },
  { f:"HNO3", right:"азотная кислота", tip:"сильная" },
  { f:"HNO2", right:"азотистая кислота", tip:"слабее HNO3" },
  { f:"H3PO4", right:"ортофосфорная кислота", tip:"3-осн." },
  { f:"H2CO3", right:"угольная кислота", tip:"нестабильна" },

  { f:"NaOH", right:"гидроксид натрия", tip:"щёлочь" },
  { f:"KOH", right:"гидроксид калия", tip:"щёлочь" },
  { f:"Ca(OH)2", right:"гидроксид кальция", tip:"малораств." },
  { f:"Ba(OH)2", right:"гидроксид бария", tip:"щёлочь" },
  { f:"Al(OH)3", right:"гидроксид алюминия", tip:"амфотерный" },
  { f:"Zn(OH)2", right:"гидроксид цинка", tip:"амфотерный" },
  { f:"Fe(OH)3", right:"гидроксид железа(iii)", tip:"Fe(+3)" },

  { f:"NaCl", right:"хлорид натрия", tip:"средняя соль" },
  { f:"K2SO4", right:"сульфат калия", tip:"соль H2SO4" },
  { f:"Na2SO3", right:"сульфит натрия", tip:"соль H2SO3" },
  { f:"CaCO3", right:"карбонат кальция", tip:"известняк" },
  { f:"Na2CO3", right:"карбонат натрия", tip:"кальц. сода" },
  { f:"NaHCO3", right:"гидрокарбонат натрия", tip:"кислая соль" },
  { f:"KNO3", right:"нитрат калия", tip:"соль HNO3" }
];

function norm(s){ return s.toLowerCase().replace(/ё/g,"е").trim(); }
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.random()* (i+1)|0; [a[i],a[j]]=[a[j],a[i]];} return a;}

let items=[], idx=0, ok=0, bad=0;
let answersState=[], selected=null, phase="choose", wrongPool=[];
let timer=null;

const qIndex=qTotal=okCount=badCount=score=null;

const elQIndex=document.getElementById("qIndex");
const elQTotal=document.getElementById("qTotal");
const elOk=document.getElementById("okCount");
const elBad=document.getElementById("badCount");
const elScore=document.getElementById("score");
const elQuestion=document.getElementById("question");
const elTip=document.getElementById("tip");
const elAnswers=document.getElementById("answers");
const elActionBtn=document.getElementById("actionBtn");
const elNav=document.getElementById("nav");

const elShuffle=document.getElementById("shuffle");
const elMix=document.getElementById("mixAnswers");
const elAutoC=document.getElementById("autoNextCorrect");
const elAutoW=document.getElementById("autoNextWrong");

document.getElementById("restartBtn").onclick=()=>start("all");
document.getElementById("repeatWrongBtn").onclick=()=>start("wrong");
document.getElementById("prevBtn").onclick=()=>go(idx-1);
document.getElementById("nextBtn").onclick=()=>go(idx+1);

elActionBtn.onclick=()=> phase==="choose"? submit(): go(idx+1);

function start(mode){
  clearTimeout(timer);
  items = mode==="wrong" && wrongPool.length ? [...wrongPool] : [...TASKS];
  if(elShuffle.checked) shuffle(items);

  idx=ok=bad=0; wrongPool=[];
  answersState=items.map(()=>({chosen:null,isCorrect:null,locked:false}));

  buildNav();
  render();
}

function buildNav(){
  elNav.innerHTML="";
  items.forEach((_,i)=>{
    const b=document.createElement("button");
    b.className="qbtn";
    b.textContent=i+1;
    b.onclick=()=>go(i);
    elNav.appendChild(b);
  });
  paintNav();
}

function paintNav(){
  [...elNav.children].forEach((b,i)=>{
    b.className="qbtn"+(i===idx?" current":"");
    const st=answersState[i];
    if(st.isCorrect===true) b.classList.add("right");
    if(st.isCorrect===false) b.classList.add("wrong");
  });
}

function go(i){
  clearTimeout(timer);
  if(i<0||i>=items.length) return;
  idx=i; render();
}

function render(){
  elQTotal.textContent=items.length;
  elQIndex.textContent=idx+1;
  elOk.textContent=ok;
  elBad.textContent=bad;
  elScore.textContent= ok+bad? Math.round(ok/(ok+bad)*100):0;

  elAnswers.innerHTML=""; selected=null; phase="choose";
  elActionBtn.textContent="Ответить"; elActionBtn.disabled=true;

  if(idx>=items.length){
    elQuestion.textContent="Готово";
    return;
  }

  const cur=items[idx];
  elQuestion.textContent="Выберите: "+cur.f;

  let opts=[cur.right,
    ...shuffle(TASKS.map(t=>t.right).filter(x=>x!==cur.right)).slice(0,3)
  ];
  if(elMix.checked) shuffle(opts);

  opts.forEach(o=>{
    const b=document.createElement("button");
    b.className="btn";
    b.textContent=o;
    b.onclick=()=>select(o,b);
    elAnswers.appendChild(b);
  });

  const st=answersState[idx];
  if(st.locked) showSaved(cur,st);
  paintNav();
}

function select(o,b){
  if(phase!=="choose")return;
  selected=o;
  [...elAnswers.children].forEach(x=>x.classList.remove("selected"));
  b.classList.add("selected");
  elActionBtn.disabled=false;
}

function submit(){
  const cur=items[idx];
  const correct=norm(selected)===norm(cur.right);
  const st=answersState[idx];

  st.chosen=selected; st.isCorrect=correct; st.locked=true;
  correct? ok++: bad++, !correct&&wrongPool.push(cur);

  showSaved(cur,st);

  if((correct&&elAutoC.checked)||(!correct&&elAutoW.checked)){
    timer=setTimeout(()=>go(idx+1),700);
  }
}

function showSaved(cur,st){
  phase="checked";
  elActionBtn.textContent="Далее"; elActionBtn.disabled=false;

  [...elAnswers.children].forEach(b=>{
    b.disabled=true;
    if(norm(b.textContent)===norm(cur.right)) b.classList.add("correct");
    if(norm(b.textContent)===norm(st.chosen)&&!st.isCorrect) b.classList.add("wrong");
  });

  elTip.textContent=cur.tip||"";
  paintNav();
}

start("all");
</script>

</body>
</html>
